/*
 * Copyright (c) Adrien Foulon - 2018. All rights reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

(function(jQuery){jQuery.fn.typeWatch=function(o){var _supportedInputTypes=["TEXT","TEXTAREA","PASSWORD","TEL","SEARCH","URL","EMAIL","DATETIME","DATE","MONTH","WEEK","TIME","DATETIME-LOCAL","NUMBER","RANGE"];var options=jQuery.extend({wait:750,callback:function(){},highlight:true,captureLength:2,inputTypes:_supportedInputTypes},o);function checkElement(timer,override){var value=jQuery(timer.el).val();if(value.length>=options.captureLength&&value.toUpperCase()!=timer.text||override&&value.length>=options.captureLength){timer.text=value.toUpperCase();timer.cb.call(timer.el,value)}}function watchElement(elem){var elementType=elem.type.toUpperCase();if(jQuery.inArray(elementType,options.inputTypes)>=0){var timer={timer:null,text:jQuery(elem).val().toUpperCase(),cb:options.callback,el:elem,wait:options.wait};if(options.highlight){jQuery(elem).focus(function(){this.select()})}var startWatch=function(evt){var timerWait=timer.wait;var overrideBool=false;var evtElementType=this.type.toUpperCase();if(typeof evt.keyCode!="undefined"&&evt.keyCode==13&&evtElementType!="TEXTAREA"&&jQuery.inArray(evtElementType,options.inputTypes)>=0){timerWait=1;overrideBool=true}var timerCallbackFx=function(){checkElement(timer,overrideBool)};clearTimeout(timer.timer);timer.timer=setTimeout(timerCallbackFx,timerWait)};jQuery(elem).on("keydown paste cut input",startWatch)}}return this.each(function(){watchElement(this)})}})(jQuery);