!function(I){"use strict";redux.field_objects=redux.field_objects||{},redux.field_objects.typography=redux.field_objects.typography||{};var O=[],B=!1,S=!0;redux.field_objects.typography.init=function(e,t){e||(e=I(document).find(".redux-group-tab:visible").find(".redux-container-typography:visible")),I(e).each(function(){var g=I(this),e=g;g.hasClass("redux-field-container")||(e=g.parents(".redux-field-container:first")),e.is(":hidden")||e.hasClass("redux-field-init")&&(e.removeClass("redux-field-init"),void 0===redux.field_objects.pro&&(S=!1),g.each(function(){g.parents(".redux-container").data("opt-name");I(this).find(".redux-typography-container").each(function(){var e=I(this).find(".redux-typography-family"),t=e.data("value");void 0===t?e=I(this):""!==t&&I(e).val(t);var a,r=I(this).find(".redux-typography-family").parents(".redux-container-typography:first").data("id"),s=I("#"+r+" .redux-typography-font-family").data("user-fonts");s=s?1:0;var o=I("#"+r+" .redux-typography-google").val();o=o?1:0;var i=[];if(void 0!==redux.optName.customfonts&&i.push(redux.optName.customfonts),void 0!==redux.optName.typekitfonts&&i.push(redux.optName.typekitfonts),void 0!==redux.optName.stdfonts&&0===s&&i.push(redux.optName.stdfonts),1===s){var p=[];for(var d in redux.optName.typography[r]){var n=redux.optName.typography[r].std_font;for(var l in n)n.hasOwnProperty(l)&&p.push({id:l,text:l,"data-google":"false"})}var y={text:"Standard Fonts",children:p};i.push(y)}(1===o||!0===o&&void 0!==redux.optName.googlefonts)&&i.push(redux.optName.googlefonts),a=i;var u=I(this).find(".redux-typography-family").data("value");I(this).find(".redux-typography-family").select2({data:a}),I(this).find(".redux-typography-family").val(u).trigger("change"),g.find(".redux-typography-family").hasClass("redux-typography-family")||g.find(".redux-typography-style").select2(),I(this).find(".redux-typography-align").select2(),I(this).find(".redux-typography-family-backup").select2(),I(this).find(".redux-typography-transform").select2(),I(this).find(".redux-typography-font-variant").select2(),I(this).find(".redux-typography-decoration").select2(),redux.field_objects.typography.select(e,!0,!1,null,!0),I(this).find(".redux-typography-family, .redux-typography-family-backup, .redux-typography-style, .redux-typography-subsets, .redux-typography-align").on("change",function(e){var t=I(this).attr("id"),a=I("#"+t);if(I(this).hasClass("redux-typography-family")){if(a.val()){var r,s=I(this).select2("data");r=s?s[0].text:null,a.data("value",r),O=s[0],B=!0,redux.field_objects.typography.select(a,!0,!1,r,!0)}}else e=a.val(),a.data("value",e),(I(this).hasClass("redux-typography-align")||I(this).hasClass("redux-typography-subsets")||I(this).hasClass("redux-typography-family-backup")||I(this).hasClass("redux-typography-transform")||I(this).hasClass("redux-typography-font-variant")||I(this).hasClass("redux-typography-decoration"))&&(a.find('option[selected="selected"]').removeAttr("selected"),a.find('option[value="'+e+'"]').attr("selected","selected")),I(this).hasClass("redux-typography-subsets")&&a.siblings(".typography-subsets").val(e),redux.field_objects.typography.select(I(this),!0,!1,null,!1)}),I(this).find(".redux-typography-size, .redux-typography-height, .redux-typography-word, .redux-typography-letter").keyup(function(){redux.field_objects.typography.select(I(this).parents(".redux-container-typography:first"))}),S&&(redux.field_objects.pro.typography.fieldChange(I(this)),redux.field_objects.pro.typography.colorPicker(I(this))),I(this).find(".redux-typography-color").wpColorPicker({change:function(e,t){I(this).val(t.color.toString()),redux.field_objects.typography.select(I(this).parents(".redux-container-typography:first"))}}),I(this).find(".redux-typography-size").numeric({allowMinus:!1}),I(this).find(".redux-typography-height, .redux-typography-word, .redux-typography-letter").numeric({allowMinus:!0}),I(this).find(".redux-typography").on("select2:unselecting",function(){var e=I(this).data("select2").options;e.set("disabled",!0),setTimeout(function(){e.set("disabled",!1)},1);var t=I(this).attr("id"),a=I("#"+t);a.data("value",""),I(this).hasClass("redux-typography-family")?(I(this).val(null).trigger("change"),redux.field_objects.typography.select(a,!0,!1,null,!0)):((I(this).hasClass("redux-typography-align")||I(this).hasClass("redux-typography-subsets")||I(this).hasClass("redux-typography-family-backup")||I(this).hasClass("redux-typography-transform")||I(this).hasClass("redux-typography-font-variant")||I(this).hasClass("redux-typography-decoration"))&&I("#"+t+' option[selected="selected"]').removeAttr("selected"),I(this).hasClass("redux-typography-subsets")&&a.siblings(".typography-subsets").val(""),I(this).hasClass("redux-typography-family-backup")&&a.val(null).trigger("change"),redux.field_objects.typography.select(I(this),!0,!1,null,!1))}),redux.field_objects.typography.updates(I(this)),window.onbeforeunload=null})}))})},redux.field_objects.typography.updates=function(s){s.find(".update-google-fonts").bind("click",function(e){var a=I(this).data("action"),r=I(this).parent().parent(),t=r.attr("data-nonce");return r.find("p").text(redux_ajax_script.update_google_fonts.updating),r.find("p").attr("aria-label",redux_ajax_script.update_google_fonts.updating),r.removeClass("updating-message updated-message notice-success notice-warning notice-error").addClass("update-message notice-warning updating-message"),I.ajax({type:"post",dataType:"json",url:redux_ajax_script.ajaxurl,data:{action:"redux_update_google_fonts",nonce:t,data:a},error:function(e){console.log(e),r.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error");var t=e.error;t&&(t=': "'+t+'"'),r.find("p").html(redux_ajax_script.update_google_fonts.error.replace("%s",a).replace("|msg",t)),r.find("p").attr("aria-label",redux_ajax_script.update_google_fonts.error),redux.field_objects.typography.updates(s)},success:function(e){if(console.log(e),"success"===e.status)r.find("p").html(redux_ajax_script.update_google_fonts.success),r.find("p").attr("aria-label",redux_ajax_script.update_google_fonts.success),r.removeClass("updating-message notice-warning").addClass("updated-message notice-success"),I(".redux-update-google-fonts").not(".notice-success").remove();else{r.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error");var t=e.error;t&&(t=': "'+t+'"'),r.find("p").html(redux_ajax_script.update_google_fonts.error.replace("%s",a).replace("|msg",t)),r.find("p").attr("aria-label",redux_ajax_script.update_google_fonts.error),redux.field_objects.typography.updates(s)}}}),e.preventDefault(),!1})},redux.field_objects.typography.size=function(e){var t,a=0;for(t in e)e.hasOwnProperty(t)&&a++;return a},redux.field_objects.typography.makeBool=function(e){return"false"!==e&&"0"!==e&&!1!==e&&0!==e&&("true"===e||"1"===e||!0===e||1===e||void 0)},redux.field_objects.typography.contrastColour=function(e){var t="#444444";""!==e&&(e=e.replace("#",""),t=128<=(299*parseInt(e.substr(0,2),16)+587*parseInt(e.substr(2,2),16)+114*parseInt(e.substr(4,2),16))/1e3?"#444444":"#ffffff");return t},redux.field_objects.typography.select=function(e,t,a,r,s){var o;void 0===(o=I(e).parents(".redux-container-typography:first").data("id"))&&(o=I(e).data("id"));var i=I("#"+o),p=I("#"+o+"-family").val();p||(p=null),r&&(p=r);var d,n=i.find("select.redux-typography-family-backup").val(),l=i.find(".redux-typography-size").val(),y=i.find(".redux-typography-height").val(),u=i.find(".redux-typography-word").val(),g=i.find(".redux-typography-letter").val(),h=i.find("select.redux-typography-align").val(),f=i.find("select.redux-typography-transform").val(),c=i.find("select.redux-typography-font-variant").val(),x=i.find("select.redux-typography-decoration").val(),v=i.find("select.redux-typography-style").val(),m=i.find("select.redux-typography-subsets").val(),b=i.find(".redux-typography-color").val(),_=i.data("units");if(!0===B?(d=redux.field_objects.typography.makeBool(O["data-google"]),i.find(".redux-typography-google-font").val(d)):d=redux.field_objects.typography.makeBool(i.find(".redux-typography-google-font").val()),s){i.hasClass("typography-initialized")||(v=i.find("select.redux-typography-style").data("value"),m=i.find("select.redux-typography-subsets").data("value"),""!==v&&(v=String(v)),void 0!==typeof m&&(m=String(m))),void 0===redux.optName.fonts.google&&(d=!1);var j=!1,C="";if(C=!0===d&&p in redux.optName.fonts.google?redux.optName.fonts.google[p]:void 0!==redux.optName.fonts.typekit&&p in redux.optName.fonts.typekit?(j=!0,redux.optName.fonts.typekit[p]):{400:"Normal 400",700:"Bold 700","400italic":"Normal 400 Italic","700italic":"Bold 700 Italic"},I(e).hasClass("redux-typography-subsets")&&i.find("input.typography-subsets").val(m),I(e).hasClass("redux-typography-family")){var w='<option value=""></option>',k="";!0===d?(I.each(C.variants,function(e,t){t.id===v||1===redux.field_objects.typography.size(C.variants)?(k=' selected="selected"',v=t.id):k="",w+='<option value="'+t.id+'"'+k+">"+t.name.replace(/\+/g," ")+"</option>"}),a&&i.find(".redux-typography-style").select2("destroy"),i.find(".redux-typography-style").html(w).select2(),k="",w='<option value=""></option>',I.each(C.subsets,function(e,t){t.id===m||1===redux.field_objects.typography.size(C.subsets)?(k=' selected="selected"',m=t.id,i.find("input.typography-subsets").val(m)):k="",w+='<option value="'+t.id+'"'+k+">"+t.name.replace(/\+/g," ")+"</option>"}),a&&i.find(".redux-typography-subsets").select2("destroy"),i.find(".redux-typography-subsets").html(w).select2(),i.find(".redux-typography-subsets").parent().fadeIn("fast"),i.find(".typography-family-backup").fadeIn("fast")):!0===j?(I.each(C.variants,function(e,t){t.id===v||1===redux.field_objects.typography.size(C.variants)?(k=' selected="selected"',v=t.id):k="",w+='<option value="'+t.id+'"'+k+">"+t.name.replace(/\+/g," ")+"</option>"}),i.find(".redux-typography-style").select2("destroy"),i.find(".redux-typography-style").html(w).select2(),i.find(".redux-typography-subsets").parent().fadeOut("fast"),i.find(".typography-family-backup").fadeOut("fast")):C&&(I.each(C,function(e,t){e===v||"normal"===e?(k=' selected="selected"',i.find(".typography-style select2-selection__rendered").text(t)):k="",w+='<option value="'+e+'"'+k+">"+t.replace("+"," ")+"</option>"}),a&&i.find(".redux-typography-style").select2("destroy"),i.find(".redux-typography-style").html(w).select2(),i.find(".redux-typography-subsets").parent().fadeOut("fast"),i.find(".typography-family-backup").fadeOut("fast")),i.find(".redux-typography-font-family").val(p)}else I(e).hasClass("redux-typography-family-backup")&&""!==n&&i.find(".redux-typography-font-family-backup").val(n)}if(s&&(0===i.find("select.redux-typography-style option[value='"+v+"']").length?(v="",i.find("select.redux-typography-style").val("").trigger("change")):"400"===v&&i.find("select.redux-typography-style").val(v).trigger("change"),0===i.find("select.redux-typography-subsets option[value='"+m+"']").length&&(m="",i.find("select.redux-typography-subsets").val("").trigger("change"),i.find("input.typography-subsets").val(m))),I("."+("style_link_"+o)).remove(),null!==p&&"inherit"!==p&&i.hasClass("typography-initialized")){var N=p.replace(/\s+/g,"+");if(!0===d){var z=N;v&&""!==v&&(z+=":"+v.replace(/\-/g," ")),m&&""!==m&&(z+="&subset="+m),!1===B&&"undefined"!=typeof WebFont&&WebFont&&WebFont.load({google:{families:[z]}}),i.find(".redux-typography-google").val(!0)}else i.find(".redux-typography-google").val(!1)}(-1!==v.indexOf("italic")?(i.find(".typography-preview").css("font-style","italic"),i.find(".typography-font-style").val("italic"),v=v.replace("italic","")):(i.find(".typography-preview").css("font-style","normal"),i.find(".typography-font-style").val("")),i.find(".typography-font-weight").val(v),y||(y=l),""===l||void 0===l?i.find(".typography-font-size").val(""):i.find(".typography-font-size").val(l+_),""===y||void 0===y?i.find(".typography-line-height").val(""):i.find(".typography-line-height").val(y+_),""===u||void 0===u?i.find(".typography-word-spacing").val(""):i.find(".typography-word-spacing").val(u+_),""===g||void 0===g?i.find(".typography-letter-spacing").val(""):i.find(".typography-letter-spacing").val(g+_),S&&redux.field_objects.pro.typography.select(o),i.hasClass("typography-initialized"))&&(0===i.find(".typography-preview").data("preview-size")&&i.find(".typography-preview").css("font-size",l+_),i.find(".typography-preview").css({"font-weight":v,"text-align":h,"font-family":p+", sans-serif"}),"none"===p&&""===p&&i.find(".typography-preview").css("font-family","inherit"),i.find(".typography-preview").css({"line-height":y+_,"word-spacing":u+_,"letter-spacing":g+_}),b&&i.find(".typography-preview").css("color",b),S&&redux.field_objects.typography.previewShadow(o),i.find(".typography-style select2-selection__rendered").text(i.find(".redux-typography-style option:selected").text()),i.find(".typography-script select2-selection__rendered").text(i.find(".redux-typography-subsets option:selected").text()),h&&i.find(".typography-preview").css("text-align",h),f&&i.find(".typography-preview").css("text-transform",f),c&&i.find(".typography-preview").css("font-variant",c),x&&i.find(".typography-preview").css("text-decoration",x),i.find(".typography-preview").slideDown());i.hasClass("typography-initialized")||i.addClass("typography-initialized"),B=!1,t||redux_change(e)}}(jQuery);