!function(a){"use strict";redux=redux||{},redux.field_objects=redux.field_objects||{},redux.field_objects.color_scheme=redux.field_objects.color_scheme||{},redux.field_objects.color_scheme.nonce="",redux.field_objects.color_scheme.fieldID="",redux.field_objects.color_scheme.optName="",redux.field_objects.color_scheme.el="",redux.field_objects.color_scheme.showTooltips="",redux.field_objects.color_scheme.default_params={},redux.field_objects.color_scheme.hexToRGBA=function(a,b){if(null===a)f="";else{a=a.replace("#","");var c=parseInt(a.substring(0,2),16),d=parseInt(a.substring(2,4),16),e=parseInt(a.substring(4,6),16),f="rgba("+c+","+d+","+e+","+b+")"}return f},redux.field_objects.color_scheme.init=function(b){b||(b=a(document).find(".redux-group-tab:visible").find(".redux-container-color_scheme:visible")),a(b).each(function(){var b=a(this),c=b;redux.field_objects.color_scheme.el=b,b.hasClass("redux-field-container")||(c=b.parents(".redux-field-container:first")),c.is(":hidden")||c.hasClass("redux-field-init")&&(c.removeClass("redux-field-init"),redux.field_objects.color_scheme.modInit(b),redux.field_objects.color_scheme.setAccordions(b),redux.field_objects.color_scheme.import(b),redux.field_objects.color_scheme.delete(b),redux.field_objects.color_scheme.save(b),redux.field_objects.color_scheme.qtip(b))})},redux.field_objects.color_scheme.qtip=function(b){var c;c=!1,!1===redux.field_objects.color_scheme.showTooltips&&(c=!0);var d=b.find(".redux-color-scheme-container").data("tooltips");if(""!==d){d=decodeURIComponent(d),d=JSON.parse(d);var e="";!0===d.style.shadow&&(e="qtip-shadow");var f="";!0===d.style.rounded&&(f="qtip-rounded");var g="";""!==d.style.color&&(g="qtip-"+d.style.color);var h="";""!==d.style.style&&(h="qtip-"+d.style.style);var i=e+","+g+","+f+","+h;i=i.replace(/,/g," ");var j=d.position.my,k=d.position.at;j=a.redux.verifyPos(j.toLowerCase(),!0),k=a.redux.verifyPos(k.toLowerCase(),!1),a("li.redux-cs-qtip").each(function(){var b=a(this).attr("qtip-content"),e=a(this).attr("qtip-title");""===b&&""===e||(!0===c?a(this).qtip("destroy",!0):a(this).qtip({content:{text:b,title:e},show:{effect:function(){"slide"===d.effect.show_effect?a(this).slideDown(d.effect.show_duration):"fade"===d.effect.show_effect?a(this).fadeIn(d.effect.show_duration):a(this).show()},event:d.effect.show_event},hide:{effect:function(){"slide"===d.effect.hide_effect?a(this).slideUp(d.effect.hide_duration):"fade"===d.effect.hide_effect?a(this).fadeOut(d.effect.hide_duration):a(this).hide()},event:d.effect.hide_event},style:{classes:i},position:{my:j,at:k}}))})}},redux.field_objects.color_scheme.setAccordions=function(b){var c=b.find("ul.redux-scheme-layout"),d=c.data("open-icon"),e=c.data("close-icon");!0===Boolean(b.find(".redux-color-scheme-container").data("accordion"))?(b.find(".redux-color-scheme-accordion-section").each(function(b,c){!1===Boolean(a(this).data("state"))?a(this).hide():(a(this).prev(".redux-color-scheme-accordion").find(".el").removeClass(d).addClass(e),redux.field_objects.color_scheme.initColorPicker(a(this)))}),b.find(".redux-color-scheme-accordion").click(function(b){b.preventDefault();var c=a(this).next(".redux-color-scheme-accordion-section");c.is(":visible")?(a(this).find(".el").removeClass(e).addClass(d),c.slideUp()):(a(this).find(".el").removeClass(d).addClass(e),redux.field_objects.color_scheme.initColorPicker(c),c.slideDown())})):redux.field_objects.color_scheme.initColorPicker(b)},redux.field_objects.color_scheme.modInit=function(b){redux.field_objects.color_scheme.nonce=b.find(".redux-color-scheme-container").data("nonce"),redux.field_objects.color_scheme.fieldID=b.find(".redux-color-scheme-container").data("id"),redux.field_objects.color_scheme.optName=b.find(".redux-color-scheme-container").data("opt-name"),redux.field_objects.color_scheme.showTooltips=b.find(".redux-color-scheme-container").data("show-tooltips"),redux.field_objects.color_scheme.default_params={triggerChange:!0,allowClear:!1};var c=b.find(".redux-container-color_scheme").find(".select2_params");if(c.size()>0){var d=c.val();d=JSON.parse(d),redux.field_objects.color_scheme.default_params=a.extend({},redux.field_objects.color_scheme.default_params,d)}if(b.find(".redux-scheme-select").select2(redux.field_objects.color_scheme.default_params),b.find("select.redux-color-scheme-opt-select").select2(redux.field_objects.color_scheme.default_params),!0===Boolean(b.find(".redux-color-scheme-container").data("dev-mode"))){var f=a(".redux-color-scheme-container").data("version"),g=a("div.redux-timer").html();void 0!==g&&a("div.redux-timer").html(g+"<br/>Color Scheme extension v."+f)}b.find("input.redux-scheme-input-"+redux.field_objects.color_scheme.fieldID).click(function(a){this.focus(),this.select(),a.preventDefault()}),b.find("input.redux-scheme-input-"+redux.field_objects.color_scheme.fieldID).val(b.find("#redux-scheme-select-"+redux.field_objects.color_scheme.fieldID).val()),b.find("#redux-scheme-select-"+redux.field_objects.color_scheme.fieldID).on("change",function(){redux.field_objects.color_scheme.selectChange(b)}),b.find("#redux-"+redux.field_objects.color_scheme.fieldID+"-tooltip-checkbox").on("change",function(){var c=a(this).is(":checked");a(this).val(c),redux.field_objects.color_scheme.showTooltips=c,redux.field_objects.color_scheme.qtip(b)})},redux.field_objects.color_scheme.import=function(b){var c=redux.field_objects.color_scheme.fieldID,d=redux.field_objects.color_scheme.optName,e=b.find("#redux-"+c+"-import-scheme-button"),f=b.find("#redux-"+c+"-import-scheme-button").data("submit");e.upload({name:"file",method:"post",action:f+"attachment.php",enctype:"multipart/form-data",fileType:".json",params:{type:"import",field_id:c,opt_name:d},autoSubmit:!0,onSubmit:function(){},onComplete:function(d){d=JSON.parse(d),b.find("#redux-"+c+"-scheme-message-notice h2").html(d.data),a.blockUI({message:b.find("#redux-"+c+"-scheme-message-notice"),theme:!1,css:{width:"500px",padding:"5px"}}),a("#redux-"+c+"-scheme-ok").click(function(){return a.unblockUI(),!0===d.result&&(window.onbeforeunload="",location.reload()),!1})},onSelect:function(){}})},redux.field_objects.color_scheme.delete=function(b){var c=redux.field_objects.color_scheme.fieldID;b.find("#redux-"+c+"-delete-scheme-button").click(function(d){d.preventDefault();var e=b.find("#redux-scheme-select-"+c).val();if("default"===e.toLowerCase())return b.find("#redux-"+c+"-scheme-message-notice h2").html("Cannot delete the <strong>Default</strong> scheme, as it is reserved."),a.blockUI({message:b.find("#redux-"+c+"-scheme-message-notice"),theme:!1,css:{width:"500px",padding:"5px"}}),a("#redux-"+c+"-scheme-ok").click(function(){return a.unblockUI(),!1}),!1;a.blockUI({message:b.find("#redux-"+c+"-delete-scheme-question"),theme:!1,css:{width:"500px",padding:"5px"}}),a("#redux-"+c+"-delete-scheme-yes").click(function(){if(e){var d={action:"redux_color_schemes",nonce:redux.field_objects.color_scheme.nonce,type:"delete",scheme_id:e,field_id:c},f=b.find("#redux-"+c+"-scheme-wait-message h1").html();a.blockUI({message:"<h1>"+f+"deleting scheme.<h1/>",theme:!1,css:{width:"500px",padding:"5px"}}),a.post(redux_ajax_script.ajaxurl,d,function(d){"success"===d?(b.find("#redux-scheme-select-"+c+" option[value='"+e+"']").remove(),b.find(".redux-scheme-select").select2(),b.find(".redux-scheme-select").val("Default").trigger("change"),b.find("input.redux-scheme-input-"+c).val(""),b.find("#redux-"+c+"-scheme-message-notice h2").html("The <strong>"+e+"</strong> scheme has been removed.<br/><br/>The color table has been reset to default values."),a.blockUI({message:b.find("#redux-"+c+"-scheme-message-notice"),theme:!1,css:{width:"500px",padding:"5px"}}),a("#redux-"+c+"-scheme-ok").click(function(){return a.unblockUI(),redux.field_objects.color_scheme.updateSchemeHTML(0,b),!1})):(b.find("#redux-"+c+"-scheme-message-notice h2").html("Delete failed: "+d),a.blockUI({message:b.find("#redux-"+c+"-scheme-message-notice"),theme:!1,css:{width:"500px",padding:"5px"}}),a("#redux-"+c+"-scheme-ok").click(function(){return a.unblockUI(),!1}))})}}),a("#redux-"+c+"-delete-scheme-no").click(function(){return a.unblockUI(),!1})})},redux.field_objects.color_scheme.save=function(b){var c=redux.field_objects.color_scheme.fieldID;b.find("#redux-"+c+"-save-scheme-button").click(function(d){d.preventDefault();var e=b.find("input.redux-scheme-input-"+c).val();if(e=e.replace(/^\s+|\s+$/gm,""),""===(e=e.replace(/[^a-z0-9\s\_\-]/gi,"")))return!1;if("default"===e.toLowerCase())return b.find("#redux-"+c+"-scheme-message-notice h2").html("The name <strong>Default</strong> cannot be used as it is reserved."),a.blockUI({message:b.find("#redux-"+c+"-scheme-message-notice"),theme:!1,css:{width:"500px",padding:"5px"}}),a("#redux-"+c+"-scheme-ok").click(function(){return a.unblockUI(),!1}),!1;var f=[];b.find(".redux-scheme-layout-container").each(function(){var b=a(this).children(".redux-color-scheme"),c=b.data("title"),d=b.data("id"),e=b.data("hex-color"),g=b.data("alpha"),h=b.data("rgba"),i=b.data("group");f.push({id:d,title:c,color:e,alpha:g,rgba:h,group:i})}),f=JSON.stringify(f),f=encodeURIComponent(f);var g=b.find(".redux-scheme-input-"+c).val();if(g){var h={action:"redux_color_schemes",nonce:redux.field_objects.color_scheme.nonce,type:"save",scheme_name:g,scheme_data:f,field_id:c},i=b.find("#redux-"+c+"-scheme-wait-message h1").html();a.blockUI({message:"<h1>"+i+"saving scheme.</h1>",theme:!1,css:{width:"500px",padding:"5px"}}),b.find(".redux-scheme-select").select2("destroy"),a.post(redux_ajax_script.ajaxurl,h,function(d){b.find("#redux-scheme-select-"+c).live("change",function(){redux.field_objects.color_scheme.selectChange(b)}),"fail"===d?b.find("#redux-"+c+"-scheme-message-notice h2").html("The scheme <strong>"+g+"</strong> already exists and cannot be added again."):(b.find("#redux-scheme-select-"+c).replaceWith(d),b.find("#redux-"+c+"-scheme-message-notice h2").html("The scheme <strong>"+g+"</strong> has been added to your scheme list.")),a.blockUI({message:b.find("#redux-"+c+"-scheme-message-notice"),theme:!1,css:{width:"500px",padding:"5px"}}),a("#redux-"+c+"-scheme-ok").click(function(){return a.unblockUI(),!1}),b.find(".redux-scheme-select").select2(redux.field_objects.color_scheme.default_params),b.find("select.redux-color-scheme-opt-select").select2(redux.field_objects.color_scheme.default_params)})}})},redux.field_objects.color_scheme.selectChange=function(a){var b=redux.field_objects.color_scheme.fieldID;a.find("ul.redux-scheme-layout").fadeOut();var c=a.find("#redux-scheme-select-"+b).val();a.find("#redux-scheme-select-"+b+" option[value='']").remove(),a.find("input.redux-scheme-input-"+b).val(c),redux.field_objects.color_scheme.updateSchemeHTML(c,a)},redux.field_objects.color_scheme.updateSchemeHTML=function(b,c){var d=redux.field_objects.color_scheme.fieldID,e=c.find("#redux-"+d+"-scheme-wait-message h1").html();a.blockUI({message:"<h1>"+e+"updating scheme.</h1>",theme:!1,css:{width:"500px",padding:"5px"}});var f=c.find(".redux-color-scheme").attr("class"),g={action:"redux_color_schemes",nonce:redux.field_objects.color_scheme.nonce,type:"update",scheme_id:b,field_id:d,field_class:f};a.post(redux_ajax_script.ajaxurl,g,function(b){c.find("ul.redux-scheme-layout").replaceWith(b),redux.field_objects.color_scheme.setAccordions(c),c.find("ul.redux-scheme-layout").fadeIn(),a.unblockUI(),redux_change(c.find(".redux-color-scheme-container")),c.find("select.redux-color-scheme-opt-select").select2(redux.field_objects.color_scheme.default_params),"function"==typeof reduxColorSchemeAfterUpdateHTML&&reduxColorSchemeAfterUpdateHTML(a(this),c)})},redux.field_objects.color_scheme.initColorPicker=function(b){var c=redux.field_objects.color_scheme.fieldID,d=b.find(".redux-color-scheme"),e=d.data("current-alpha");e=Number(null===e||void 0===e?1:e);var f=d.data("current-color");f=""===f||"transparent"===f?"":f;var g=d.data("output-transparent");g=Boolean(""!==g&&g);var h=redux.field_objects.color_scheme.el.find(".redux-color-scheme-container"),i=h.data("palette");i=decodeURIComponent(i),null===(i=JSON.parse(i))&&(i=[["#000000","#434343","#666666","#999999","#b7b7b7","#cccccc","#d9d9d9","#efefef","#f3f3f3","#ffffff"],["#980000","#ff0000","#ff9900","#ffff00","#00ff00","#00ffff","#4a86e8","#0000ff","#9900ff","#ff00ff"],["#e6b8af","#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d9ead3","#c9daf8","#cfe2f3","#d9d2e9","#ead1dc"],["#dd7e6b","#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#a4c2f4","#9fc5e8","#b4a7d6","#d5a6bd"],["#cc4125","#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6d9eeb","#6fa8dc","#8e7cc3","#c27ba0"],["#a61c00","#cc0000","#e69138","#f1c232","#6aa84f","#45818e","#3c78d8","#3d85c6","#674ea7","#a64d79"],["#85200c","#990000","#b45f06","#bf9000","#38761d","#134f5c","#1155cc","#0b5394","#351c75","#741b47"],["#5b0f00","#660000","#783f04","#7f6000","#274e13","#0c343d","#1c4587","#073763","#20124d","#4c1130"]]);var j=h.data("picker-gap");j=String(""===j?"60px":j);var k=h.data("picker-font-size");k=String(""===k?"11px":k);var l=h.data("show-input");l=Boolean(""!==l&&l);var m=h.data("show-initial");m=Boolean(""!==m&&m);var n=h.data("show-alpha");n=Boolean(""!==n&&n);var o=h.data("allow-empty");o=Boolean(""!==o&&o);var p=h.data("show-palette");p=Boolean(""!==p&&p);var q=h.data("show-palette-only");q=Boolean(""!==q&&q);var r=h.data("show-selection-palette");r=Boolean(""!==r&&r);var s=Number(h.data("max-palette-size")),t=h.data("clickout-fires-change");t=Boolean(""!==t&&t);var u=String(h.data("choose-text")),v=String(h.data("cancel-text")),w=h.data("show-buttons");w=Boolean(""!==w&&w);var x=String(h.data("container-class")),y=String(h.data("replacer-class"));b.find("li.redux-scheme-layout").css("width",j),b.find(".redux-layout-label").attr("style","font-size: "+k+"!important"),d.spectrum({color:f,showAlpha:n,showInput:l,allowEmpty:o,className:"redux-full-spectrum",showInitial:m,showPalette:p,showSelectionPalette:r,maxPaletteSize:s,showPaletteOnly:q,clickoutFiresChange:t,chooseText:u,cancelText:v,showButtons:w,containerClassName:x,replacerClassName:y,preferredFormat:"hex6",localStorageKey:"redux.spectrum."+c,palette:i,change:function(c){var d,e,f;null===c?(d=!0===g?"transparent":null,e=null):(d=c.toHexString(),e=c.getAlpha()),f="transparent"!==d?redux.field_objects.color_scheme.hexToRGBA(d,e):"transparent";var h=a(this).data("block-id"),i=b.find("input#"+h+"-data"),j=i.val();j=decodeURIComponent(j),j=JSON.parse(j),j.color=d,j.alpha=e,j.rgba=f,j=JSON.stringify(j),j=encodeURIComponent(j),i.val(j),redux_change(redux.field_objects.color_scheme.el.find(".redux-color-scheme-container"))}})}}(jQuery);